function capIt(e){return e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})}app.controller("map",["$scope","group","map","memory","$location",function(e,o,t,n,r){e.name=n.name,e.link=location.href,e.results=[],o.members||(o.members=[]),n.groups||(n.groups={}),n.groups[o.id()]?e.isCreator=n.groups[o.id()].creator:e.isCreator=!1,e.showingSharing=!1,e.showingSettings=!1,e.expand=function(e){document.querySelector("#"+e).classList.toggle("expand")},e.toggleIgnore=function(t){e.isCreator&&t?o.toggleIgnore(t):o.toggleIgnore(n.name)},e.search=function(){t.search(function(o){e.results=o})};var s=function(){n.name||(n.name=prompt("name",""),e.name=n.name);var s=o.joinGroup({name:n.name,lat:t.location.lat,lng:t.location.lng},function(){o.online(n.name),n.groups[o.id().toString()]={name:o.name,creator:o.members[n.name].creator,votes:n.groups[o.id()]?n.groups[o.id()].votes:{}};for(var t in o.options.types)t in n.groups[o.id()].votes||(o.options.types[t]++,n.groups[o.id()].votes[t]=!0);e.updateList(),e.isCreator=o.members[n.name].creator});s||r.path("/"),t.listen()};t.requestLocation(function(){t.createMap(),o.ready(s)&&s()}),e.showGroup=!1,e.members=[],e.updateList=function(){e.meetingName=o.name,e.members=[];for(var t in o.members)e.members.push(o.members[t]),e.members[e.members.length-1].name=t;if(e.radius=o.options.radius,e.types=[],n.groups[o.id()])for(var r in o.options.types)e.types.push({name:capIt(r.replace(/_/g," ")),type:r,value:n.groups[o.id()].votes[r]})},e.toggleVote=function(t,r){e.types[t].value=!e.types[t].value,o.updateVotes(r,e.types[t].value),n.groups[o.id()].votes[r]=e.types[t].value},e.showResult=function(o){e.mode="map",t.setLocation(o)},o.onUpdate(e.updateList)}]);